# Nyanko Bot - Build a chat bot with [Telegram Bot API](https://core.telegram.org/bots/)
Nyanko Bot can translate from English to Vietnamese using a pretrained model generated by [tensor2tensor](https://github.com/tensorflow/tensor2tensor)
To build a Telegram bot, refer to [this tutorial](https://chatbotslife.com/your-first-chatbot-using-telegram-and-python-part-1-796894016ba8)
Here are steps
This is the remake chatbot, for the origin and most detailed, refer to [this repo](https://github.com/larycoder/chatbots)

## Repo's structure
* NyankoBot
  * colab/: stores data and model needed for translation
  * decodeF2F.py: main script using decode from file to file
  * decodeWServing: main script using decode with tensorflow server
  * Translator.py: function for decode from file to file
  * TranslateWithServing: function for decode with serving

## Running
### Using decode from file to file
python decodeF2F.py
### Using decode with serving
Please refer to [this page](https://github.com/tensorflow/tensor2tensor/tree/master/tensor2tensor/serving) for more information
* Requirements: tensorflow-model-server, tensorflow-serving-api
```console
sudo apt install tensorflow-model-server
pip install tensorflow-serving-api
```
* export model for serving
```console
t2t-exporter \
  --model=transformer \
  --hparams_set=transformer_base \
  --problem=translate_envi_iwslt32k \
  --data_dir=colab/data \
  --output_dir=colab/train
```
you should have export/ directory inside colab/train/ now
* launch server
```console
tensorflow_model_server \
  --port=9000 \
  --model_name=translator\
  --model_base_path=absolute_path_to_export_folder
```
* query the server
```console
t2t-query-server \
  --server=localhost:9000 \
  --servable_name=translator \
  --problem=translate_envi_iwslt32k \
  --data_dir=~colab/data
  --inputs_once='your sentence'
```
for interactive querying, remove flag --inputs_once
* Deployment with chatbot
The deployment is inside [decodeWServing.py](decodeWServing.py)
To run the bot:
  * launch server as above
  * python decodeWServer.py


